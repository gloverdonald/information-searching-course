<!doctype html>
<html lang="ru" data-vue-meta="%7B%22lang%22:%7B%22ssr%22:%22ru%22%7D%7D">
 <head>
  <title>Я построю свой почтовый сервер с Postfix и Dovecot / Хабр</title>
 </head>
 <body>
  <div id="app" data-server-rendered="true" data-async-called="true">
   <div class="tm-layout__wrapper">
    <!---->
    <div></div><!---->
    <header class="tm-header">
     <div class="tm-page-width">
      <div class="tm-header__container">
       <!----> <span class="tm-header__logo-wrap"> <span class="tm-header__beta-sign" style="display:none;">β</span></span>
       <div class="tm-dropdown tm-header__projects">
        <div class="tm-dropdown__head">
         <button class="tm-header__dropdown-toggle"></button>
        </div><!---->
       </div>
       <div class="tm-feature tm-header__feature tm-feature tm-feature_variant-inline">
        <!---->
       </div><!----> <!---->
      </div>
     </div>
    </header>
    <div class="tm-layout">
     <div class="tm-page-progress-bar"></div>
     <div data-menu-sticky="true" class="tm-base-layout__header tm-base-layout__header_is-sticky">
      <div class="tm-page-width">
       <div class="tm-base-layout__header-wrapper">
        <div class="tm-main-menu">
         <div class="tm-main-menu__section">
          <nav class="tm-main-menu__section-content">
          </nav>
         </div>
        </div>
        <div class="tm-header-user-menu tm-base-layout__user-menu">
         <!----> <!----> <!---->
         <div class="tm-header-user-menu__item">
          <button class="tm-header-user-menu__toggle"></button>
         </div> <!---->
         <div class="v-portal" style="display:none;"></div>
        </div>
       </div>
      </div>
     </div><!---->
     <div class="tm-page-width"></div>
     <main class="tm-layout__container">
      <div hl="ru" data-async-called="true" class="tm-page">
       <div class="tm-page-width">
        <!---->
        <div class="tm-page__wrapper">
         <div class="tm-page__main tm-page__main_has-sidebar">
          <div class="pull-down">
           <!---->
           <div class="pull-down__header" style="height:0px;">
            <div class="pull-down__content" style="bottom:10px;"></div>
           </div>
           <div class="tm-adfox-banner__container">
            <!---->
            <div id="adfox_169815559787254866" class="tm-adfox-banner tm-adfox-banner tm-adfox-banner_variant-narrow"></div>
           </div>
           <div class="tm-article-presenter">
            <div class="tm-article-presenter__body">
             <div class="tm-misprint-area">
              <div class="tm-misprint-area__wrapper">
               <article class="tm-article-presenter__content tm-article-presenter__content_narrow">
                <div class="tm-article-presenter__header">
                 <div class="tm-article-snippet tm-article-presenter__snippet tm-article-snippet">
                  <div class="tm-article-snippet__meta-container">
                   <div class="tm-article-snippet__meta">
                    <span class="tm-user-info tm-article-snippet__author"> <span class="tm-user-info__user tm-user-info__user_appearance-default"> <span class="tm-article-datetime-published"><time datetime="2013-09-13T09:12:26.000Z" title="2013-09-13, 13:12">13 сен 2013 в 13:12</time></span></span></span>
                   </div><!---->
                  </div>
                  <h1 lang="ru" class="tm-title tm-title_h1"><span>Я построю свой почтовый сервер с Postfix и Dovecot</span></h1>
                  <div class="tm-article-snippet__stats">
                   <!---->
                   <div class="tm-article-reading-time">
                    <span class="tm-svg-icon__wrapper tm-article-reading-time__icon"></span> <span class="tm-article-reading-time__label"> 20 мин </span>
                   </div><span class="tm-icon-counter tm-data-icons__item"> <span class="tm-icon-counter__value">306K</span></span>
                  </div>
                  <div class="tm-publication-hubs__container">
                   <div class="tm-publication-hubs">
                    <span class="tm-publication-hub__link-container"></span><span class="tm-publication-hub__link-container"></span>
                   </div>
                  </div>
                  <div class="tm-article-labels">
                   <div class="tm-article-labels__container">
                    <div class="tm-publication-label tm-publication-label_variant-tutorial">
                     <span> Туториал </span>
                    </div>
                   </div>
                  </div><!----> <!---->
                 </div>
                </div><!---->
                <div data-gallery-root="" lang="ru" class="tm-article-body">
                 <div></div>
                 <div id="post-content-body">
                  <div>
                   <div class="article-formatted-body article-formatted-body article-formatted-body_version-1">
                    <div xmlns="http://www.w3.org/1999/xhtml">
                     <br>
                     <br>
                      В рамках программы по унификации установленных серверных систем встала задача по переделке почтового сервера. Вдумчивое изучение мануалов и руководств показало довольно любопытный факт – нигде не было найдено однозначно достоверного руководства или подобия Best Practice по развёртыванию почтовика.
                     <br>
                     <br>
                      Мануал пошаговый, основывается на внутренней документации компании и затрагивает совершенно очевидные вопросы. Гуру могут не тратить время, ноу-хау здесь нет – руководство является сборной солянкой и публикуется только потому, что все найденные руководства по развёртыванию почтовика напоминали картинку о том, как рисовать сову.
                     <br>
                     <br>
                      Для тех, кто не хочет собирать всё вручную, оптимальным вариантом, пожалуй, будет пакет . Отличная сборка Postfix, Dovecot, Apache, MySQL/PostgreSQL, Policyd, Amavis, Fail2ban, Roundcube и даже Awstats. Ставится легко, работает стабильно, есть красивая админка (бесплатная) и очень красивая админка (платная) не идущая ни в какое сравнение с убогим PostfixAdmin. Поклонники же ручного труда могут продолжить чтение.
                     <br>
                     <br>
                      Старый сервер работал под Gentoo и нёс в себе термоядерный заряд из Postfix+VDA с Courier и глючно реализованного SASL, решавшим подключаться к mysql только при первой аутентификации. План переделки заключался в миграции на наш внутренний стандарт – CentOS. Роль MTA и MDA возлагается на связку Postfix и Dovecot, а в качестве вспомогательной артиллерии: Amavis + SpamAssassin + ClamAV + Postgrey + Fail2Ban. Письма хранятся в файлах, а учётные записи и домены — в MySQL. На сервере крутится несколько почтовых доменов и есть поддержка виртуальных квот.
                     <br>
                     <br>
                     <br>
                     <br>
                     <br>
                     <br>
                     <br><b>[*]</b> Подключаем дополнительные репозитории. Мне хватило <b>epel, rpmforge, centalt и remi</b>. Не все они нужны постоянно включёнными, и можно установить плагин yum-priorities; ну или если лень разбираться, то включать-отключать их руками. Далее я буду говорить, что из какого репозитория устанавливается.
                     <br>
                     <br><b>[*]</b> Работа с <b>SELinux</b> достойна отдельного материала, поэтому в рамках данной статьи примем, что selinux по-ламерски сделан permissive или disabled. 
                     <br>
                     <br><b>[*]</b> Не забываем про <b>ntp</b>:
                     <br>
                     <pre><code class="bash">yum install ntp
ntpdate &lt;ваш ntp сервер&gt;
chkconfig ntpd on &amp;&amp; /etc/init.d/ntpd start
</code></pre>
                     <br>
                      Это позволит избежать возможной проблемы Dovecot’a «Time has moved backwards». Также можно в <i>/etc/sysconfig/ntpd</i> изменить ключ на -L, чтобы ntpd не слушал сеть.
                     <br>
                     <br><b>[*]</b> В завершение подготовительного этапа ставим утилиты, которые облегчат нам тестирование и дальнейшую работу:
                     <br>
                     <pre><code class="bash">yum install wget mlocate bind-utils telnet mailx sharutils
</code></pre>
                     <br>
                     <br>
                     <br>
                     <br>
                     <br>
                     <br>
                      Для нашей базы данных используем <b>MySQL 5.5 от Remi</b>. Можно и mariadb, конечно, но пока MySQL ещё жив, вышеупомянутая сборка меня полностью устраивает. Версия важна, т.к. при обновлении Postfix до 2.10 он захочет новую версию и если поставить 5.1 из base, то обновление постфикса из CentALT потянет за собой MariaDB. Кому больше нравится PgSQL — пожалуйста, ставьте его. Развёртывание ничем отличаться не будет, даже конфигурационные файлы postfix можно будет брать неизменными. Отличаться будет только настройка самого postgresql и создание базы.
                     <br>
                     <br>
                      Для запуска подойдёт вариант «из коробки» (в репозитории ниже представлен слегка расширенный my.cnf). Создаём пользователя <b>postfix</b> с одноимённой базой и всеми правами на неё.
                     <br>
                     <pre><code class="sql">CREATE USER postfix@localhost IDENTIFIED BY 'mypassword';
CREATE DATABASE postfix;
GRANT ALL PRIVILEGES ON postfix.* TO postfix;
</code></pre>
                     <br>
                     <br>
                      Антивирусом у меня работает <b>ClamAV</b>. Стоит отметить, что самая последняя версия есть на CentALT, однако она в упор не хочет оттуда скачиваться, умирая на попытке скачать 50 мегабайт clamav-db. Поэтому ставим из <b>EPEL</b> на пару минорных версий меньше, погоды это не сделает. Clam будет работать у нас через сокет, поэтому в <i>/etc/clamd.conf</i> комментируем строки:
                     <br>
                     <pre><code class="bash">#TCPSocket 3310
#TCPAddr 127.0.0.1
</code></pre>
                     <br>
                      Обновление баз антивируса подключается автоматически, за него отвечает утилита <b>freshclam</b>. Проконтролируем, чтобы соответствующий файл находился в <i>cron.daily</i> и запускаем сервис антивируса
                     <br>
                     <pre><code class="bash">freshclam
chkconfig clamd on &amp;&amp; /etc/init.d/clamd start
</code></pre>
                     <br>
                     <br>
                     <br>
                     <br>
                     <br>
                     <br>
                      Развёртывать или не развёртывать веб-интерфейс — личное дело каждого. Мне он понадобился для контроля процесса миграции. Вам он может понадобиться для создания структуры базы и администрирования доменов, ящиков, алиасов и т.п. Для последних задач в большинстве руководств активно предлагается <b>PostfixAdmin</b>, но мне он категорически не нравится. Равно как я бы рекомендовал придерживаться принципа разделения, по которому почтовый сервер должен заниматься обработкой почты, веб-сервер держать веб-приложения, а DB-сервер работать с базами данных. 
                     <br>
                     <br>
                      Для тех, кто не захочет развёртывать веб-подсистему, прилагаю SQL-дамп базы данных для почтового сервера на все случаи жизни. Даже с некоторыми неиспользуемыми возможностями: .
                     <br>
                     <br>
                      Если же потребуется PostfixAdmin — ставьте <b>nginx/apache + php</b> и собственно сам <b>PostfixAdmin</b>. И обратите внимание, что <font color="darkred">развернуть его поверх приведённого дампа не удастся</font> — из структуры удалены некоторые «лишние» таблицы. Нюансов настройки PostfixAdmin немного. Редактируем <i>config.inc.php</i>, обращая внимание на следующие параметры:
                     <br>
                     <pre><code class="php">## должен содержать тот же метод хэширования пароля, что и dovecot
$CONF['encrypt'] = 'md5crypt';
$CONF['transport_default'] = 'virtual';
$CONF['emailcheck_resolve_domain']='NO';
## Поскольку будет использоваться dovecot, убираем префикс
$CONF['create_mailbox_subdirs_prefix']='';
## На случай, если захочется использовать хранение квот не в maildir, а в базе данных через dict
$CONF['new_quota_table'] = 'yes';
</code></pre>
                     <br>
                      После этого можно идти на , генерировать пароль и создавать учётную запись супер-администратора. Теперь сгенерированный хэш надо внести в файл config.inc.php и изменить его статус:
                     <br>
                     <pre><code class="php">$CONF['configured'] = true;
$CONF['setup_password'] = 't8h9i9s2i7s7m2y4l9o8g9i4n:a0n9d5p2a5s2s9w5o4r7d';
</code></pre>
                     <br><b>[!]</b> Postfixadmin сам создаёт структуру базы и в mysql, и в postgresql при запуске setup.php. Если намереваетесь использовать его, установку следует проводить на пустую базу.
                     <br>
                     <br>
                     <br>
                     <br>
                     <br>
                     <br>
                     <br>
                      Проконтролируем, что в базе postfix создана вся дефолтная структура и перейдём к установке MTA и MDA. <b>Postfix</b> уже идёт в комплекте с CentOS, но не самый новый. Обновим его из <b>CentALT</b> и оттуда же поставим Dovecot.
                     <br>
                     <pre><code class="bash">yum update postfix
yum install dovecot dovecot-mysql
</code></pre>
                     <br>
                     <br>
                      Все основные системы корабля будут оперировать с файлами в <i>/var/vmail</i> под отдельным юзверем:
                     <br>
                     <pre><code class="bash">groupadd  -g 1000 vmail
useradd -d /var/vmail/ -g 1000 -u 1000 vmail
chown vmail:vmail /var/vmail
</code></pre>
                     <br>
                     <br>
                      Сделаем самоподписанные SSL'ки
                     <br>
                     <pre><code class="bash">mkdir /etc/postfix/certs
openssl req -new -x509 -days 3650 -nodes -out /etc/postfix/certs/cert.pem -keyout /etc/postfix/certs/key.pem
</code></pre>
                     <br>
                     <br>
                      Самый противный этап сборки – убедить Postfix работать с базой данных:
                     <br>
                     <pre><code class="bash">mkdir /etc/postfix/mysql
</code></pre>
                     <br>
                      В этой директории создаём файлы со следующим содержанием:
                     <br>
                     <div class="spoiler">
                      <b class="spoiler_title">Конфигурация postfix mysql</b>
                      <div class="spoiler_text">
                       <b>relay_domains.cf</b>
                       <br>
                       <pre><code class="bash">hosts = localhost
user = postfix
password = mypassword
dbname = postfix
query = SELECT domain FROM domain WHERE domain='%s' and backupmx = '1'
</code></pre>
                       <br>
                       <br><b>virtual_alias_domain_maps.cf</b>
                       <br>
                       <pre><code class="bash">hosts = localhost
user = postfix
password = mypassword
dbname = postfix
query = SELECT goto FROM alias,alias_domain WHERE alias_domain.alias_domain = '%d' and alias.address = CONCAT('%u', '@', alias_domain.target_domain) AND alias.active = 1
</code></pre>
                       <br>
                       <br><b>virtual_alias_maps.cf</b>
                       <br>
                       <pre><code class="bash">hosts = localhost
user = postfix
password = mypassword
dbname = postfix
query = SELECT goto FROM alias WHERE address='%s' AND active = '1'
</code></pre>
                       <br>
                       <br><b>virtual_mailbox_domains.cf</b>
                       <br>
                       <pre><code class="bash">hosts = localhost
user = postfix
password = mypassword
dbname = postfix
query = SELECT domain FROM domain WHERE domain='%s' AND backupmx = '0' AND active = '1'
</code></pre>
                       <br>
                       <br><b>virtual_mailbox_maps.cf</b>
                       <br>
                       <pre><code class="bash">hosts = localhost
user = postfix
password = mypassword
dbname = postfix
query = SELECT maildir FROM mailbox WHERE username='%s' AND active = '1'
</code></pre>
                       <br>
                      </div>
                     </div>
                     <br>
                     <br>
                      Редактируем файл <i>/etc/postfix/main.cf</i>, обучая Postfix работать с базой по свежесозданным файлам:
                     <br>
                     <pre><code class="bash"># ============================================================
# MySQL mappings
# ============================================================
relay_domains = mysql:/etc/postfix/mysql/relay_domains.cf
virtual_alias_maps = mysql:/etc/postfix/mysql/virtual_alias_maps.cf,
                     mysql:/etc/postfix/mysql/virtual_alias_domain_maps.cf
virtual_mailbox_domains = mysql:/etc/postfix/mysql/virtual_mailbox_domains.cf
virtual_mailbox_maps = mysql:/etc/postfix/mysql/virtual_mailbox_maps.cf
</code></pre>
                     <br>
                     <br>
                      Хороший почтовый сервер пропускает своих и авторизует чужих. Чтобы аутентификация работала корректно, запустим <b>Submission</b>, подняв SMTP сервис дополнительно на 587 порту. Смартфоны при создании новых учётных записей при вписывании smtp сервера с аутентификацией по умолчанию предлагают 587 порт; вы же не хотите объяснять клиентам, что недостаточно вписать mail.domain.tld, а ещё надо и порты какие-то прописывать. В общем, в <i>/etc/postfix/master.cf</i> редактируем секцию, отвечающую за submission:
                     <br>
                     <pre><code class="bash">submission inet n       -       n       -       -       smtpd
  -o syslog_name=postfix/submission
  -o smtpd_tls_wrappermode=no
  -o smtpd_tls_security_level=encrypt
  -o smtpd_sasl_auth_enable=yes
  -o smtpd_recipient_restrictions=permit_mynetworks,permit_sasl_authenticated,reject
  -o smtpd_relay_restrictions=permit_mynetworks,permit_sasl_authenticated,defer_unauth_destination
  -o milter_macro_daemon_name=ORIGINATING
</code></pre>
                     <br><b>[!] </b>Обязательно обращаем внимание на пробелы перед <b>-o</b> ключами — без них конфиг не будет валидным. 
                     <br>
                     <br>
                      Пока отложим в сторону master.cf, к нему мы вернёмся позднее, и продолжим с <i>/etc/postfix/main.cf</i>
                     <br>
                     <pre><code class="bash">soft_bounce = no
myhostname = mail.domain.tld
mydomain = domain.tld
myorigin = $myhostname

# Убираем $myhostname и $mydomain из локального класа
# Чтобы не было do not list domain in BOTH mydestination and virtual_mailbox_domains
mydestination = localhost.$mydomain, localhost

## Вписываем свои сетки
## Обязательно отредактировать и сузить до максимально узкого диапазона
## Лучше вообще не использовать и не позволять отправку почты без авторизации
mynetworks = 192.168.0.0/16, 127.0.0.0/8

## Убираем nis:/ чтобы избежать спама в лог 
## dict_nis_init: NIS domain name not set - NIS lookups disabled
alias_maps = hash:/etc/aliases

smtpd_banner = $myhostname ESMTP $mail_name
debug_peer_level = 2
debug_peer_list = 127.0.0.1
</code></pre>
                     <br>
                     <br>
                      Это были изменения строк по умолчанию. А теперь добавим несколько секций наших настроек. Проверьте на дубликаты, убирая их из родной конфигурации, если они там встречаются. Я предлагаю свои настройки вписывать структурированными блоками в нижней части файла <i>/etc/postfix/main.cf</i>:
                     <br>
                     <div class="spoiler">
                      <b class="spoiler_title">Очередная конфигурационная простыня</b>
                      <div class="spoiler_text">
                       <pre><code class="bash"># ============================================================
# RESTRICTIONS
#
# Uncomment reject_rbl_client if necessary
# More information at: http://help.ubuntu.ru/wiki/фильтрация_спама_на_уровне_smtp_протокола
# ============================================================
smtpd_discard_ehlo_keywords = etrn, silent-discard
smtpd_forbidden_commands = CONNECT GET POST
broken_sasl_auth_clients = yes
smtpd_delay_reject = yes
smtpd_helo_required = yes
disable_vrfy_command = yes

smtpd_helo_restrictions = permit_mynetworks,
                          permit_sasl_authenticated,
                          reject_non_fqdn_helo_hostname,
                          reject_invalid_helo_hostname

smtpd_data_restrictions = permit_mynetworks,
                          permit_sasl_authenticated,
                          reject_unauth_pipelining,
                          reject_multi_recipient_bounce,

smtpd_sender_restrictions = permit_mynetworks,
                            permit_sasl_authenticated,
                            reject_non_fqdn_sender,
                            reject_unknown_sender_domain

smtpd_recipient_restrictions = reject_non_fqdn_recipient,
                               reject_unknown_recipient_domain,
                               reject_multi_recipient_bounce,
                               permit_mynetworks,
                               permit_sasl_authenticated,
                               reject_unauth_destination,
                               check_policy_service unix:/var/spool/postfix/postgrey/socket,
                               #reject_rbl_client zen.spamhaus.org,
                               #reject_rbl_client bl.spamcop.net,
                               #reject_rbl_client dnsbl.sorbs.net,
                               reject_invalid_hostname

# ============================================================
# TLS
# ============================================================
smtp_tls_security_level = may
smtpd_tls_security_level = may
smtpd_tls_loglevel = 1
smtpd_tls_received_header = yes
smtpd_tls_session_cache_timeout = 3600s
smtp_tls_session_cache_database = btree:$data_directory/smtp_tls_session_cache
smtpd_tls_key_file = /etc/postfix/certs/key.pem
smtpd_tls_cert_file = /etc/postfix/certs/cert.pem
tls_random_source = dev:/dev/urandom

# ============================================================
# LIMITS
# ============================================================
message_size_limit = 51200000
smtpd_soft_error_limit = 10
smtpd_hard_error_limit = 15
smtpd_error_sleep_time = 20
anvil_rate_time_unit = 60s
smtpd_client_connection_count_limit = 20
smtpd_client_connection_rate_limit = 30
smtpd_client_message_rate_limit = 30
smtpd_client_event_limit_exceptions = 127.0.0.1/8
smtpd_client_connection_limit_exceptions = 127.0.0.1/8

# ============================================================
# QUEUE
# ============================================================
maximal_queue_lifetime = 1d
bounce_queue_lifetime = 1d
</code></pre>
                       <br>
                      </div>
                     </div>
                     <br><b>[!]</b> Использовать или не использовать чёрные списки — ваш выбор. Я закомментировал соответствующие директивы <b>reject_rbl_client</b>, чтобы не плодить холивары. Грейлистинга зачастую хватает, а Spamhaus и иже с ним исповедуют неоднозначную политику, но на практике оказалось, что «честных ребят», в чёрные списки просто так не заносит и ложных срабатываний у нас не было. Повезло, наверное. Поэтому — дело вкуса включать директивы RBL или нет. Считайте, что я их указал в информационных целях.
                     <br><b>[!] </b>Параметры разбиты по группам — внимательно пересмотрите их и подстройте под собственные нужды. Хуже нет варианта, чем вслепую влепить чужой конфиг без правок.
                     <br><b>[!] </b>  справедливо заметил, что опция `permit_mynetworks` крайне сомнительна и опасна. Гораздо лучше будет её убрать и разрешать отправку корреспонденции только пользователям, прошедшим аутентификацию. 
                     <br><b>[!] </b>К файлу main.cf мы снова вернёмся, добавляя в него <b>postgrey</b>, <b>amavis</b> и <b>dovecot</b>, а пока перейдем к MDA
                     <br>
                     <br>
                     <br>
                     <br>
                     <br>
                     <br>
                     <br>
                      Что это такое:
                     <br>
                     <ul>
                     </ul>
                     <br>
                     <br>
                      Пара изменений в <i>/etc/dovecot/dovecot.conf</i>:
                     <br>
                     <pre><code class="bash">protocols = imap pop3
login_greeting = Hello there.
</code></pre>
                     <br>
                      Остальная часть конфигурационного файла удобно разбита на составляющие и прекрасно документирована:
                     <br>
                     <div class="spoiler">
                      <b class="spoiler_title">10-auth.conf</b>
                      <div class="spoiler_text">
                       <pre><code class="bash">disable_plaintext_auth = no
auth_realms = domain.tld domain2.tld
auth_default_realm = domain.tld
auth_mechanisms = plain login
## [!] Комментируем auth-system.conf.ext, чтобы не 
## заставлять dovecot искать пользователя в pam
#!include auth-system.conf.ext
</code></pre>
                       <br>
                      </div>
                     </div>
                     <br>
                     <div class="spoiler">
                      <b class="spoiler_title">10-logging.conf</b>
                      <div class="spoiler_text">
                       Отдельного перечисления не будет — по желанию включаем нужные опции.
                       <br>
                      </div>
                     </div>
                     <br>
                     <div class="spoiler">
                      <b class="spoiler_title">10-mail.conf</b>
                      <div class="spoiler_text">
                       mail_location = maildir:/var/vmail/%d/%n
                       <br>
                        mail_uid = 1000
                       <br>
                        mail_gid = 1000
                       <br>
                        mail_plugins = quota
                       <br>
                      </div>
                     </div>
                     <br>
                     <div class="spoiler">
                      <b class="spoiler_title">10-master.conf</b>
                      <div class="spoiler_text">
                       <pre><code class="bash"># Поднимаем imap и imaps
service imap-login {
  inet_listener imap {
    port = 143
  }
  inet_listener imaps {
    port = 993
    ssl = yes
  }
}

# Поднимаем pop3 и pop3s
service pop3-login {
  inet_listener pop3 {
    port = 110
  }
  inet_listener pop3s {
    port = 995
    ssl = yes
  }
}

# Поднимаем SASL, куда будет ходить postfix
service auth {
  unix_listener auth-userdb {
    mode = 0600
    user = vmail
    group = vmail
  }
  unix_listener /var/spool/postfix/private/auth {
    mode = 0666
    user=postfix
    group=postfix
  }
}
</code></pre>
                       <br>
                      </div>
                     </div>
                     <br>
                     <div class="spoiler">
                      <b class="spoiler_title">10-ssl.conf</b>
                      <div class="spoiler_text">
                       ssl = yes
                       <br>
                        ssl_cert = &lt;/etc/postfix/certs/cert.pem
                       <br>
                        ssl_key = &lt;/etc/postfix/certs/key.pem
                       <br>
                      </div>
                     </div>
                     <br>
                     <div class="spoiler">
                      <b class="spoiler_title">15-lda.conf</b>
                      <div class="spoiler_text">
                       quota_full_tempfail = no
                       <br>
                        lda_mailbox_autocreate = yes
                       <br>
                        lda_mailbox_autosubscribe = yes
                       <br>
                        protocol lda {
                       <br>
                        mail_plugins = $mail_plugins autocreate
                       <br>
                        }
                       <br>
                      </div>
                     </div>
                     <br>
                     <div class="spoiler">
                      <b class="spoiler_title">20-imap.conf</b>
                      <div class="spoiler_text">
                       protocol imap {
                       <br>
                        mail_plugins = $mail_plugins autocreate quota imap_quota
                       <br>
                        }
                       <br>
                      </div>
                     </div>
                     <br>
                     <div class="spoiler">
                      <b class="spoiler_title">90-plugin.conf</b>
                      <div class="spoiler_text">
                       <pre><code class="bash"># Данные для вас могут отличаться.
# Такие папки создавались для безболезненной миграции со старой системы
plugin {
  autocreate = Trash
  autocreate2 = sent-mail
  autocreate3 = drafts
  autosubscribe = Trash
  autosubscribe2 = sent-mail
  autosubscribe3 = drafts
}
</code></pre>
                       <br>
                      </div>
                     </div>
                     <br>
                     <div class="spoiler">
                      <b class="spoiler_title">90-quota.conf</b>
                      <div class="spoiler_text">
                       <pre><code class="bash"># Отредактируйте значения в соответствии с собственными нуждами.
plugin {
  quota_rule = *:storage=200M
  quota_rule2 = Trash:storage=+10M
}

plugin {
  quota_warning = storage=90%% quota-warning 90 %u
}

# Проверьте, чтобы у скрипта был нужный chmod
# Плюс чтобы в quota-warning.sh был указан корректный путь до dovecot-lda
service quota-warning {
  executable = script /usr/local/bin/quota-warning.sh
  user = vmail
  unix_listener quota-warning {
    user = vmail
  }
}

# Формат хранения квоты - maildir
# При желании можно менять на dict, fs или dirsize
# Подробная документация в http://wiki2.dovecot.org/Quota
plugin {
  quota = maildir:User quota
}
</code></pre>
                       <br>
                      </div>
                     </div>
                     <br>
                     <div class="spoiler">
                      <b class="spoiler_title">auth-sql.conf.ext</b>
                      <div class="spoiler_text">
                       passdb {
                       <br>
                        driver = sql
                       <br>
                        args = /etc/dovecot/dovecot-sql.conf.ext
                       <br>
                        }
                       <br>
                        userdb {
                       <br>
                        driver = sql
                       <br>
                        args = /etc/dovecot/dovecot-sql.conf.ext
                       <br>
                        }
                       <br>
                      </div>
                     </div>
                     <br>
                     <br>
                      Создаём <i>/etc/dovecot/dovecot-sql.conf.ext</i>:
                     <br>
                     <div class="spoiler">
                      <b class="spoiler_title">dovecot-sql.conf.ext</b>
                      <div class="spoiler_text">
                       driver = mysql
                       <br>
                        connect = host=localhost dbname=postfix user=postfix password=mypassword
                       <br>
                        default_pass_scheme = MD5-CRYPT
                       <br>
                        user_query = SELECT '/var/vmail/%d/%n' as home, 'maildir:/var/vmail/%d/%n'as mail, 1000 AS uid, 1000 AS gid, concat('*:bytes=', quota) AS quota_rule FROM mailbox WHERE username = '%u' AND active = '1'
                       <br>
                        password_query = SELECT username as user, password, '/var/vmail/%d/%n' as userdb_home, 'maildir:/var/vmail/%d/%n' as userdb_mail, 1000 as userdb_uid, 1000 as userdb_gid, concat('*:bytes=', quota) AS userdb_quota_rule FROM mailbox WHER
                       <br>
                        E username = '%u' AND active = '1'
                       <br>
                      </div>
                     </div>
                     <br>
                     <br>
                      Теперь подружим <b>Postfix</b> с <b>Dovecot</b>. Добавим две секции в <i>/etc/postfix/main.cf</i>:
                     <br>
                     <pre><code class="bash"># ============================================================
# SASL
# ============================================================
smtpd_sasl_auth_enable = yes
smtpd_sasl_security_options = noanonymous
smtpd_sasl_type = dovecot
smtpd_sasl_path = private/auth

# ============================================================
# VIRTUAL
# ============================================================
virtual_mailbox_base = /var/vmail
virtual_minimum_uid = 1000
virtual_uid_maps = static:1000
virtual_gid_maps = static:1000
virtual_transport = dovecot
dovecot_destination_recipient_limit = 1
</code></pre>
                     <br>
                     <br>
                      И поставим <b>Postfix</b> перед фактом, что доставкой почты занимается dovecot. В <i>/etc/postfix/master.cf</i>:
                     <br>
                     <pre><code class="bash"># ====================================================================
# DOVECOT
# ====================================================================
dovecot unix    -       n       n       -       -      pipe
  flags=DRhu user=vmail:vmail argv=/usr/libexec/dovecot/deliver -f ${sender} -d ${recipient}
</code></pre>
                     <br>
                     <br>
                      Далее необходимо проконтролировать, чтобы скрипт предупреждения о превышении квоты <i>/usr/local/bin/quota-warning.sh</i> отрабатывал корректно. В моём случае в CentOS путь в нём был указан неверно и пришлось править его вручную. Его в любом случае, кстати, поправить вручную, отредактировав адрес отправителя, который по умолчанию указан, как <i>postmaster@domain.tld</i>. Найдём искомый бинарник
                     <br>
                     <pre><code class="bash">updatedb
locate dovecot-lda
chmod 755 /usr/local/bin/quota-warning.sh
</code></pre>
                     <br>
                      И поправим путь в самом <i>/usr/local/bin/quota-warning.sh</i>, при желании добавляя в скрипт более содержательные заголовки.
                     <br>
                     <br>
                     <br>
                     <br>
                     <br>
                     <br>
                     <br>
                      Поскольку у нас будет работать <b>Amavis</b>, который является прослойкой между почтовыми агентами и антивирусно-антиспамовыми системами, то запускать spamd отдельно не нужно – он работает как модуль, подгружающийся при необходимости. Чтобы SA держать обновлённым, используется родная утилита <b>sa-update</b>. Убедимся, что в <i>etc/cron.d</i> есть файлик <b>sa-update</b> с запланированным запуском апдейтера.
                     <br>
                     <br><b>[!]</b> Ставьте <b>spamassassin 3.3.2</b> из <b>rpmforge-extras</b>, т.к. втыкающаяся из EPEL версия 3.3.1 имеет врождённый дефект в sa-update. Последняя версия <u><b>3.3.2</b></u> уже избавлена от этой проблемы и обновляется корректно
                     <br>
                     <pre><code class="bash">yum install spamassassin amavisd-new
</code></pre>
                     <br>
                      Немного подкорректируем <i>/etc/mail/spamassassin/local.cf</i>
                     <br>
                     <div class="spoiler">
                      <b class="spoiler_title">local.cf</b>
                      <div class="spoiler_text">
                       <pre><code class="bash">required_hits 6
report_safe 0
rewrite_header Subject ***SPAM***

#
# WEIRD STUFF
#
score FORGED_MUA_OUTLOOK 2.199 2.199 0.963 1.116
score FH_DATE_PAST_20XX 0.0
score DOS_OE_TO_MX_IMAGE 0.0
score DOS_OE_TO_MX 0.0
score DOS_OUTLOOK_TO_MX 0.0
score TO_NO_BRKTS_DIRECT 0.0
score HELO_LOCALHOST 0.0
score FSL_RU_URL 0.0
score FROM_MISSP_EH_MATCH 1.0
score TVD_RCVD_SINGLE 1.0
score TO_IN_SUBJ 1.0

#
# TUNING
#
score SUBJ_FULL_OF_8BITS 0.00
score HTML_COMMENT_8BITS 0.01
score HEADER_8BITS 0.00
score TO_NO_USER 0.01
score FORGED_MUA_OUTLOOK 0.5
score X_AUTH_WARNING 0.01
score SUBJ_HAS_UNIQ_ID 9.99
score HTTP_USERNAME_USED 9.99
score FORGED_YAHOO_RCVD 9.99
score FORGED_JUNO_RCVD 16
score UNWANTED_LANGUAGE_BODY 1.02
score MLM 5.55
score RCVD_NUMERIC_HELO 4.95

#
# WHITE/BLACK LISTS
#
whitelist_from root@localhost
whitelist_from *@example.com
blacklist_from *@outblaze.com
auto_whitelist_path /etc/mail/spamassassin/auto-whitelist
auto_whitelist_file_mode 0666
</code></pre>
                       <br>
                      </div>
                     </div>
                     <br>
                     <br>
                      А вот конфигурационный файл <b>Amavis</b>'а — полная противоположность расхваливаемым мною конфигам Dovecot. Он представляет собой обычный perl скрипт, который к тому же ещё и плохо форматирован. Я вношу изменения просто — переименовываю файл в .pl и редактирую с подсветкой синтаксиса; это хоть немного облегчает жизнь.
                     <br>
                     <div class="spoiler">
                      <b class="spoiler_title">amavisd.conf</b>
                      <div class="spoiler_text">
                       <pre><code class="perl"># количество экземпляров amavisd
# должно совпадать с указанным в /etc/postfix/master.cf
$max_servers = 4;

# Домен по умолчанию
$mydomain = 'domain.tld';

# Правим доверенные подсетки
@mynetworks = qw( 127.0.0.0/8 [::1] [FE80::]/10 [FEC0::]/10
                  10.0.0.0/8 172.16.0.0/12 192.168.0.0/16 );

# Твик для 2.6.4 и старше. Избавляемся от предупреждения в логе 
# Open relay? Nonlocal recips but not originating
@client_ipaddr_policy = map { $_ =&gt; 'MYNETS' } @mynetworks;

# Переписываем пороговые значения для spamassassin
$sa_tag_level_deflt  = 2.0;
$sa_tag2_level_deflt = 5.2;
$sa_kill_level_deflt = 6.5;
$sa_dsn_cutoff_level = 10; 

# Куда будут отправляться уведомления о письмах с вирусами и спамом
$virus_admin               = "virusalert\@$mydomain";
$mailfrom_notify_admin     = "virusalert\@$mydomain";
$mailfrom_notify_recip     = "virusalert\@$mydomain";
$mailfrom_notify_spamadmin = "abuse\@$mydomain";     

# Обязательно указываем имя хоста сервера
$myhostname = 'mail.domain.tld'; 

# Что делать при срабатывании
$final_virus_destiny      = D_DISCARD;
$final_banned_destiny     = D_BOUNCE;
$final_spam_destiny       = D_DISCARD;
$final_bad_header_destiny = D_PASS;

# Если будем использовать карантин, то указываем куда карантинить
# Разумеется, соответствующие почтовые ящики должны существовать
$virus_quarantine_to = "virus-quarantine\@$mydomain";
$spam_quarantine_to  = "spamtrap\@$mydomain";

# Если надо какие-то адреса или домены внести в белый список
# создаём массив
@whitelist_sender_maps = ( new_RE(
    qr'.*@example\.com$'i,
    qr'user@test\.org$'i,
));

# Весь массив @av_scanners сокращаем до
@av_scanners = (
  ['ClamAV-clamd',
    \&amp;ask_daemon, ["CONTSCAN {}\n", "/var/run/clamav/clamd.sock"],
    qr/\bOK$/m, qr/\bFOUND$/m,
    qr/^.*?: (?!Infected Archive)(.*) FOUND$/m ],
);

);

# И второй тоже
@av_scanners_backup = (
  ['ClamAV-clamscan', 'clamscan',
  "--stdout --no-summary -r --tempdir=$TEMPBASE {}",
  [0], qr/:.*\sFOUND$/m, qr/^.*?: (?!Infected Archive)(.*) FOUND$/m ],
);
</code></pre>
                       <br>
                      </div>
                     </div>
                     <br>
                      Теперь сообщим <b>Postfix</b>'у, что отныне он использует <b>Amavis</b> для проверки почты. Вносим соответствующий блок в <i>/etc/postfix/master.cf</i>
                     <br>
                     <div class="spoiler">
                      <b class="spoiler_title">master.cf</b>
                      <div class="spoiler_text">
                       <pre><code class="bash"># ====================================================================
# AMAVIS
# ====================================================================
amavisfeed unix -       -       n       -       4       lmtp
  -o lmtp_data_done_timeout=1200
  -o lmtp_send_xforward_command=yes
  -o disable_dns_lookups=yes
  -o max_use=20
127.0.0.1:10025 inet n    -       n       -       -     smtpd
  -o content_filter=
  -o smtpd_delay_reject=no
  -o smtpd_client_restrictions=permit_mynetworks,reject
  -o smtpd_helo_restrictions=
  -o smtpd_sender_restrictions=
  -o smtpd_recipient_restrictions=permit_mynetworks,reject
  -o smtpd_data_restrictions=reject_unauth_pipelining
  -o smtpd_end_of_data_restrictions=
  -o smtpd_restriction_classes=
  -o mynetworks=127.0.0.0/8,192.168.0.0/16
  -o smtpd_error_sleep_time=0
  -o smtpd_soft_error_limit=1001
  -o smtpd_hard_error_limit=1000
  -o smtpd_client_connection_count_limit=0
  -o smtpd_client_connection_rate_limit=0
  -o receive_override_options=no_header_body_checks,no_unknown_recipient_checks,no_milters,no_address_mappings
  -o local_header_rewrite_clients=
  -o smtpd_milters=
  -o local_recipient_maps=
  -o relay_recipient_maps=
</code></pre>
                       <br>
                      </div>
                     </div>
                     <br>
                      и в <i>/etc/postfix/main.cf</i> добавляем
                     <br>
                     <pre><code class="bash"># ============================================================
# AMAVIS
# ============================================================
content_filter=amavisfeed:[127.0.0.1]:10024
</code></pre>
                     <br>
                      Отрабатываем сервисы:
                     <br>
                     <pre><code class="bash">chkconfig amavisd on &amp;&amp; /etc/init.d/amavisd start
/etc/init.d/postfix restart

telnet 127.0.0.1 10024
# 220 [127.0.0.1] ESMTP amavisd-new service ready
</code></pre>
                     <br>
                     <br>
                     <br>
                     <br>
                     <br>
                     <br>
                     <br>
                      Об эффективности грейлистинга писалось уже не раз, поэтому просто молча
                     <br>
                     <pre><code class="bash">yum install postgrey
</code></pre>
                     <br>
                     <br>
                      Никакой дополнительной конфигурации не требуется — прописываем его в <i>/etc/postfix/main.cf</i>
                     <br>
                     <pre><code class="bash">smtpd_recipient_restrictions = ...
                               reject_unauth_destination,
                               check_policy_service unix:/var/spool/postfix/postgrey/socket,
                               ...
</code></pre>
                     <br><b>[!]</b> Директива check_policy_service должна <i>обязательно</i> идти после reject_unauth_destination.
                     <br>
                      Если есть необходимость исключить из проверки какие-либо сервера — редактируем <i>/etc/postfix/postgrey_whitelist_clients.local</i>, а для исключения из проверки конкретные почтовые адреса на локальном сервере — редактируем <i>postgrey_whitelist_recipients</i>. Исчерпывающая информация доступна в вики: 
                     <br>
                     <br>
                      Про <b>Fail2ban</b> разговор отдельный. Чтобы продемонстрировать его эффективность, покажу картинку со статистикой почтового сервера до и после установки утилиты. Красная линия на графике – неавторизованная долбёжка в поисках открытого релея. Письма, конечно, отсекаются, да и нагрузку большую не создают, но зачем вообще слушать этот мусор. Поэтому установка fail2ban с тремя правилами значительно улучшают внешний вид графика:
                     <br>
                     <div style="text-align:center;"></div>
                     <br>
                     <br>
                     <pre><code class="bash">yum install fail2ban
</code></pre>
                     <br>
                     <div class="spoiler">
                      <b class="spoiler_title">Правила для почтового сервера /etc/fail2ban/jail.conf</b>
                      <div class="spoiler_text">
                       <pre><code class="bash"># Тут оставляем и редактируем общие
# правила, игнорируемые подсетки
# и политику партии

##
## Убедитесь, что путь к логам соответствует действительности
##

[ssh-iptables]
enabled  = true
filter   = sshd
action   = iptables[name=SSH, port=ssh, protocol=tcp]
logpath  = /var/log/secure
maxretry = 5

[postfix-banhammer]
enabled  = true
filter   = postfix
action   = iptables-multiport-tcp[name=PFIX, port="smtp,smtps", protocol=tcp]
logpath  = /var/log/maillog
maxretry = 3
bantime  = 7200

[dovecot-banhammer]
enabled  = true
filter   = dovecot
action   = iptables-multiport-tcp[name=DCOT, port="pop3,pop3s,imap,imaps", protocol=tcp]
logpath  = /var/log/maillog
findtime = 300
maxretry = 10
bantime  = 1800

[sasl-banhammer]
enabled  = true
filter   = sasl
action   = iptables-multiport-tcp[name=SASL, port="smtp,smtps", protocol=tcp]
logpath  = /var/log/maillog
findtime = 300
maxretry = 10
bantime  = 1800
</code></pre>
                       <br>
                      </div>
                     </div>
                     <br>
                      Если SSH открыт только на внутреннюю сеть, то первое правило можно и убрать. И всё, никаких дополнительных телодвижений – правила работают «из коробки». Спасибо  за напоминание о защите от перебора smtp.
                     <br>
                     <pre><code class="bash">chkconfig fail2ban on &amp;&amp; /etc/init.d/fail2ban start
</code></pre>
                     <br>
                     <br>
                     <br>
                     <br>
                     <br>
                     <br>
                      Поскольку в Dovecot мы подключили плагин <i>autocreate</i>, то для создания доменов и почтовых ящиков достаточно завести их в базу через Postfixadmin или делая INSERT INTO в консоли. При первой же аутентификации или первом полученном письме структура директорий будет создана автоматически.
                     <br>
                     <br>
                     <div class="spoiler">
                      <b class="spoiler_title">Потестируем pop3, imap, smtp в разных позах</b>
                      <div class="spoiler_text">
                       <ol>
                       </ol>
                       <br>
                      </div>
                     </div>
                     <br>
                     <div class="spoiler">
                      <b class="spoiler_title">Потестируем антивирусную защиту</b>
                      <div class="spoiler_text">
                       <ol>
                       </ol>
                       <br>
                      </div>
                     </div>
                     <br>
                     <br>
                     <br>
                     <br>
                     <br>
                     <br>
                      Теперь <s>питание компьютера можно отключить</s> можно начинать работать с почтовым сервером, создавать домены, пользователей, алиасы и т.п. Напоследок несколько общих моментов и рекомендаций:
                     <br>
                     <br>
                     <ol>
                     </ol>
                     <br>
                     <br><font color="darkred">Почти полную сборку конфигурационных файлов я выложил </font>, чтобы при необходимости можно было получить доступ к конфигурационным файлам не по кусочкам, а целиком. В этой статье файлы редактировались постепенно, имитируя такую же постепенную настройку всех систем. В подавляющем большинстве руководств файлы давались сразу и у читателя не получалось составить представление что за чем идёт и как связывается. Я постарался от этого избавиться, показывая поэтапность настройки. Авось, кому-то да пригодится.
                     <br>
                     <br>
                      Ещё раз подчеркну, что <i>это начальный этап установки</i>. Даже если не считать подключение мониторинга, который крайне желателен на почтовом сервере, работы ещё непочатый край. Однозначно потребуется тщательная настройка антиспам политики; если планируется использовать дополнительные релеи, то потребуется доработка запросов; обязательно будет нужно выверять параметры ограничений и т.п.
                     <br>
                     <br>
                      Но в остальном на этом пробу пера в написании масштабного руководства можно считать завершённой. В планах есть публикация материала уже не для «начинающих» и не по почтовому серверу, но я решил потренироваться на кошках. Кто дочитал до этого места… гм… завидую вашему терпению, но разбивать публикацию на несколько частей представлялось нецелесообразным.
                    </div>
                   </div>
                  </div><!----> <!---->
                 </div><!----> <!---->
                </div><!---->
                <div class="tm-article-presenter__meta">
                 <div class="tm-article-presenter__meta-list tm-separated-list">
                  <span class="tm-separated-list__title">Теги:</span>
                  <ul class="tm-separated-list__list">
                   <!---->
                  </ul>
                 </div>
                 <div class="tm-article-presenter__meta-list tm-separated-list">
                  <span class="tm-separated-list__title">Хабы:</span>
                  <ul class="tm-separated-list__list">
                   <!---->
                  </ul>
                 </div>
                </div><!---->
               </article>
              </div><!---->
             </div>
             <div class="tm-article-sticky-panel">
              <div class="tm-data-icons tm-article-sticky-panel__icons">
               <div class="tm-article-rating tm-data-icons__item">
                <div title="Всего голосов 78: ↑74 и ↓4" class="tm-votes-lever tm-article-rating__votes-switcher tm-votes-lever tm-votes-lever_appearance-article">
                 <button title="Нравится" type="button" class="tm-votes-lever__button"></button>
                 <div class="tm-votes-lever__score tm-votes-lever__score tm-votes-lever__score_appearance-article">
                  <span><span class="tm-votes-lever__score-counter tm-votes-lever__score-counter tm-votes-lever__score-counter_positive"> +70 </span></span>
                 </div><button title="Не нравится" type="button" class="tm-votes-lever__button"></button>
                </div>
                <div class="v-portal" style="display:none;"></div><!---->
               </div><!----> <!----> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-data-icons__item"><span class="tm-svg-icon__wrapper bookmarks-button__icon"></span> <span title="Количество пользователей, добавивших публикацию в закладки" class="bookmarks-button__counter"> 1000 </span></button>
               <div title="Поделиться" class="tm-sharing tm-data-icons__item">
                <button type="button" class="tm-sharing__button"></button>
                <div class="v-portal" style="display:none;"></div>
               </div>
               <div title="Читать комментарии" class="tm-article-comments-counter-link tm-data-icons__item">
                <!---->
               </div><!---->
               <div class="v-portal" style="display:none;"></div>
              </div>
             </div>
            </div>
            <div class="tm-article-presenter__footer">
             <div class="tm-article-blocks">
              <!---->
              <section class="tm-block tm-block tm-block_spacing-bottom">
               <!---->
               <div class="tm-block__body tm-block__body tm-block__body_variant-balanced">
                <div class="tm-article-author">
                 <div class="tm-user-card tm-article-author__user-card tm-user-card tm-user-card_variant-article">
                  <div class="tm-user-card__info-container">
                   <div class="tm-user-card__header">
                    <div class="tm-user-card__header-data">
                     <div class="tm-user-card__meta">
                      <div title=" 62 голоса " class="tm-counter-container tm-karma tm-karma">
                       <div class="tm-counter-container__header">
                        <div class="tm-karma__votes tm-karma__votes_positive">
                         56
                        </div>
                       </div>
                       <div class="tm-counter-container__footer">
                        <div class="tm-karma__text">
                         Карма
                        </div>
                        <div class="v-portal" style="display:none;"></div>
                       </div>
                      </div>
                      <div title="Рейтинг пользователя" class="tm-counter-container">
                       <div class="tm-counter-container__header">
                        <div class="tm-votes-lever tm-votes-lever tm-votes-lever_appearance-rating">
                         <!---->
                         <div class="tm-votes-lever__score tm-votes-lever__score tm-votes-lever__score_appearance-rating">
                          <span><span class="tm-votes-lever__score-counter tm-votes-lever__score-counter tm-votes-lever__score-counter_rating"> 0 </span></span>
                         </div><!---->
                        </div>
                       </div>
                       <div class="tm-counter-container__footer">
                        <span class="tm-rating__text tm-rating__text"> Рейтинг </span>
                       </div>
                      </div>
                     </div>
                    </div>
                   </div>
                   <div class="tm-user-card__info tm-user-card__info tm-user-card__info_variant-article">
                    <div class="tm-user-card__title tm-user-card__title tm-user-card__title_variant-article">
                     <span class="tm-user-card__name tm-user-card__name tm-user-card__name_variant-article">Shader, a.k.a</span> <!---->
                    </div>
                    <p class="tm-user-card__short-info tm-user-card__short-info tm-user-card__short-info_variant-article">Администратор, программист</p>
                   </div>
                  </div>
                  <div class="tm-user-card__buttons tm-user-card__buttons tm-user-card__buttons_variant-article">
                   <!----> <!----> <!----> <!---->
                  </div>
                 </div><!---->
                </div>
               </div><!---->
              </section>
              <div class="tm-adfox-banner__container tm-page-article__banner">
               <!---->
               <div id="adfox_164725660339535756" class="tm-adfox-banner tm-adfox-banner tm-adfox-banner_variant-leaderboard"></div>
              </div>
              <div class="tm-article-blocks__comments">
               <div id="publication-comments" class="tm-article-page-comments">
                <div class="tm-article-comments-counter-link tm-article-comments-counter-button">
                 <!---->
                </div>
               </div>
              </div>
              <section class="tm-block tm-block tm-block_spacing-bottom">
               <header class="tm-block__header tm-block__header tm-block__header_variant-borderless">
                <div class="tm-block__header-container">
                 <h2 class="tm-block__title tm-block__title tm-block__title_variant-large">Публикации</h2>
                </div><!---->
               </header>
               <div class="tm-block__body tm-block__body tm-block__body_variant-condensed-slim">
                <div class="tm-tabs tm-tabs">
                 <div>
                  <span class="tm-tabs__tab-item"><button class="tm-tabs__tab-link tm-tabs__tab-link tm-tabs__tab-link_active tm-tabs__tab-link_slim"> Лучшие за сутки </button></span><span class="tm-tabs__tab-item"><button class="tm-tabs__tab-link tm-tabs__tab-link tm-tabs__tab-link_slim"> Похожие </button></span>
                 </div><!---->
                </div>
                <div class="similar-and-daily__tab-view">
                 <div class="placeholder-wrapper">
                  <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!---->
                  <div class="tm-placeholder-article-cards">
                   <div class="tm-placeholder-article-card">
                    <div class="tm-placeholder__user">
                     <div class="tm-placeholder__user-pic loads"></div>
                     <div class="tm-placeholder__user-date loads"></div>
                    </div>
                    <div class="tm-placeholder-article-card__title">
                     <div class="tm-placeholder__line tm-placeholder-article-card__title-line loads"></div>
                     <div class="tm-placeholder__line tm-placeholder-article-card__title-line loads"></div>
                    </div>
                    <div class="tm-placeholder-article-card__icons tm-placeholder__counters">
                     <div class="tm-placeholder-data-icon">
                      <div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div>
                      <div class="tm-placeholder__line tm-placeholder__line_icon-text"></div>
                     </div>
                     <div class="tm-placeholder-data-icon">
                      <div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div>
                      <div class="tm-placeholder__line tm-placeholder__line_icon-text"></div>
                     </div>
                     <div class="tm-placeholder-data-icon">
                      <div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div>
                      <div class="tm-placeholder__line tm-placeholder__line_icon-text"></div>
                     </div>
                     <div class="tm-placeholder-data-icon">
                      <div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div>
                      <div class="tm-placeholder__line tm-placeholder__line_icon-text"></div>
                     </div>
                    </div>
                   </div>
                   <div class="tm-placeholder-article-card">
                    <div class="tm-placeholder__user">
                     <div class="tm-placeholder__user-pic loads"></div>
                     <div class="tm-placeholder__user-date loads"></div>
                    </div>
                    <div class="tm-placeholder-article-card__title">
                     <div class="tm-placeholder__line tm-placeholder-article-card__title-line loads"></div>
                     <div class="tm-placeholder__line tm-placeholder-article-card__title-line loads"></div>
                    </div>
                    <div class="tm-placeholder-article-card__icons tm-placeholder__counters">
                     <div class="tm-placeholder-data-icon">
                      <div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div>
                      <div class="tm-placeholder__line tm-placeholder__line_icon-text"></div>
                     </div>
                     <div class="tm-placeholder-data-icon">
                      <div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div>
                      <div class="tm-placeholder__line tm-placeholder__line_icon-text"></div>
                     </div>
                     <div class="tm-placeholder-data-icon">
                      <div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div>
                      <div class="tm-placeholder__line tm-placeholder__line_icon-text"></div>
                     </div>
                     <div class="tm-placeholder-data-icon">
                      <div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div>
                      <div class="tm-placeholder__line tm-placeholder__line_icon-text"></div>
                     </div>
                    </div>
                   </div>
                   <div class="tm-placeholder-article-card">
                    <div class="tm-placeholder__user">
                     <div class="tm-placeholder__user-pic loads"></div>
                     <div class="tm-placeholder__user-date loads"></div>
                    </div>
                    <div class="tm-placeholder-article-card__title">
                     <div class="tm-placeholder__line tm-placeholder-article-card__title-line loads"></div>
                     <div class="tm-placeholder__line tm-placeholder-article-card__title-line loads"></div>
                    </div>
                    <div class="tm-placeholder-article-card__icons tm-placeholder__counters">
                     <div class="tm-placeholder-data-icon">
                      <div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div>
                      <div class="tm-placeholder__line tm-placeholder__line_icon-text"></div>
                     </div>
                     <div class="tm-placeholder-data-icon">
                      <div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div>
                      <div class="tm-placeholder__line tm-placeholder__line_icon-text"></div>
                     </div>
                     <div class="tm-placeholder-data-icon">
                      <div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div>
                      <div class="tm-placeholder__line tm-placeholder__line_icon-text"></div>
                     </div>
                     <div class="tm-placeholder-data-icon">
                      <div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div>
                      <div class="tm-placeholder__line tm-placeholder__line_icon-text"></div>
                     </div>
                    </div>
                   </div>
                   <div class="tm-placeholder-article-card">
                    <div class="tm-placeholder__user">
                     <div class="tm-placeholder__user-pic loads"></div>
                     <div class="tm-placeholder__user-date loads"></div>
                    </div>
                    <div class="tm-placeholder-article-card__title">
                     <div class="tm-placeholder__line tm-placeholder-article-card__title-line loads"></div>
                     <div class="tm-placeholder__line tm-placeholder-article-card__title-line loads"></div>
                    </div>
                    <div class="tm-placeholder-article-card__icons tm-placeholder__counters">
                     <div class="tm-placeholder-data-icon">
                      <div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div>
                      <div class="tm-placeholder__line tm-placeholder__line_icon-text"></div>
                     </div>
                     <div class="tm-placeholder-data-icon">
                      <div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div>
                      <div class="tm-placeholder__line tm-placeholder__line_icon-text"></div>
                     </div>
                     <div class="tm-placeholder-data-icon">
                      <div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div>
                      <div class="tm-placeholder__line tm-placeholder__line_icon-text"></div>
                     </div>
                     <div class="tm-placeholder-data-icon">
                      <div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div>
                      <div class="tm-placeholder__line tm-placeholder__line_icon-text"></div>
                     </div>
                    </div>
                   </div>
                   <div class="tm-placeholder-article-card">
                    <div class="tm-placeholder__user">
                     <div class="tm-placeholder__user-pic loads"></div>
                     <div class="tm-placeholder__user-date loads"></div>
                    </div>
                    <div class="tm-placeholder-article-card__title">
                     <div class="tm-placeholder__line tm-placeholder-article-card__title-line loads"></div>
                     <div class="tm-placeholder__line tm-placeholder-article-card__title-line loads"></div>
                    </div>
                    <div class="tm-placeholder-article-card__icons tm-placeholder__counters">
                     <div class="tm-placeholder-data-icon">
                      <div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div>
                      <div class="tm-placeholder__line tm-placeholder__line_icon-text"></div>
                     </div>
                     <div class="tm-placeholder-data-icon">
                      <div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div>
                      <div class="tm-placeholder__line tm-placeholder__line_icon-text"></div>
                     </div>
                     <div class="tm-placeholder-data-icon">
                      <div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div>
                      <div class="tm-placeholder__line tm-placeholder__line_icon-text"></div>
                     </div>
                     <div class="tm-placeholder-data-icon">
                      <div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div>
                      <div class="tm-placeholder__line tm-placeholder__line_icon-text"></div>
                     </div>
                    </div>
                   </div>
                  </div><!----> <!----> <!----> <!----> <!---->
                 </div><!---->
                </div>
               </div><!---->
              </section>
              <div>
               <div class="placeholder-wrapper">
                <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!---->
                <div class="tm-placeholder-promo">
                 <div class="tm-placeholder-promo__header">
                  <div class="tm-placeholder__line tm-placeholder__line_promo-title"></div>
                 </div>
                 <div class="tm-placeholder-promo__body">
                  <div class="tm-placeholder-promo__posts">
                   <div class="tm-placeholder-promo__post">
                    <div class="tm-placeholder-promo__image"></div>
                    <div class="tm-placeholder__line tm-placeholder__line_post-title"></div>
                   </div>
                   <div class="tm-placeholder-promo__post">
                    <div class="tm-placeholder-promo__image"></div>
                    <div class="tm-placeholder__line tm-placeholder__line_post-title"></div>
                   </div>
                   <div class="tm-placeholder-promo__post">
                    <div class="tm-placeholder-promo__image"></div>
                    <div class="tm-placeholder__line tm-placeholder__line_post-title"></div>
                   </div>
                  </div>
                  <div class="tm-placeholder-promo__dots">
                   <div class="tm-placeholder-promo__dot"></div>
                   <div class="tm-placeholder-promo__dot"></div>
                   <div class="tm-placeholder-promo__dot"></div>
                  </div>
                 </div>
                </div><!----> <!----> <!----> <!----> <!----> <!---->
               </div>
              </div>
              <div hubs="linux,sys_admin" class="placeholder-wrapper">
               <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!---->
               <div class="tm-placeholder-inset tm-placeholder-questions">
                <div class="tm-placeholder-inset__header">
                 <div class="tm-placeholder__line tm-placeholder__line_inset-header loads"></div>
                </div>
                <div class="tm-placeholder-inset__body">
                 <ul class="tm-placeholder-list"></ul>
                </div>
                <div class="tm-placeholder-inset__footer">
                 <div class="tm-placeholder__line tm-placeholder__line_inset-footer loads"></div>
                </div>
               </div><!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!---->
              </div><!---->
             </div>
            </div>
           </div>
          </div>
         </div>
         <div class="tm-page__sidebar">
          <div class="tm-layout-sidebar">
           <div class="tm-layout-sidebar__ads tm-layout-sidebar__ads_initial">
            <div class="tm-adfox-banner__container tm-layout-sidebar__banner tm-layout-sidebar__banner_top">
             <!---->
             <div id="adfox_164725680533065327" class="tm-adfox-banner tm-adfox-banner tm-adfox-banner_variant-half-page"></div>
            </div>
           </div>
           <div class="tm-sexy-sidebar tm-sexy-sidebar_initial" style="margin-top:0px;">
            <!---->
            <section data-navigatable="" tabindex="0" data-async-called="true" class="tm-block tm-stories-block tm-block tm-block_spacing-around">
             <header class="tm-block__header tm-block__header">
              <div class="tm-block__header-container">
               <h2 class="tm-block__title tm-block__title">Истории</h2>
              </div><!---->
             </header>
             <div class="tm-block__body tm-block__body tm-block__body_variant-equal">
              <div class="tm-stories-empty">
               <div class="tm-stories-card-empty">
                <div class="tm-stories-card-empty__image"></div>
                <div class="tm-stories-card-empty__title">
                 <div class="tm-stories-card-empty__title-block"></div>
                 <div class="tm-stories-card-empty__title-block"></div>
                 <div class="tm-stories-card-empty__title-block"></div>
                </div>
               </div>
               <div class="tm-stories-card-empty">
                <div class="tm-stories-card-empty__image"></div>
                <div class="tm-stories-card-empty__title">
                 <div class="tm-stories-card-empty__title-block"></div>
                 <div class="tm-stories-card-empty__title-block"></div>
                 <div class="tm-stories-card-empty__title-block"></div>
                </div>
               </div>
               <div class="tm-stories-card-empty">
                <div class="tm-stories-card-empty__image"></div>
                <div class="tm-stories-card-empty__title">
                 <div class="tm-stories-card-empty__title-block"></div>
                 <div class="tm-stories-card-empty__title-block"></div>
                 <div class="tm-stories-card-empty__title-block"></div>
                </div>
               </div>
               <div class="tm-stories-card-empty">
                <div class="tm-stories-card-empty__image"></div>
                <div class="tm-stories-card-empty__title">
                 <div class="tm-stories-card-empty__title-block"></div>
                 <div class="tm-stories-card-empty__title-block"></div>
                 <div class="tm-stories-card-empty__title-block"></div>
                </div>
               </div>
               <div class="tm-stories-card-empty">
                <div class="tm-stories-card-empty__image"></div>
                <div class="tm-stories-card-empty__title">
                 <div class="tm-stories-card-empty__title-block"></div>
                 <div class="tm-stories-card-empty__title-block"></div>
                 <div class="tm-stories-card-empty__title-block"></div>
                </div>
               </div>
               <div class="tm-stories-card-empty">
                <div class="tm-stories-card-empty__image"></div>
                <div class="tm-stories-card-empty__title">
                 <div class="tm-stories-card-empty__title-block"></div>
                 <div class="tm-stories-card-empty__title-block"></div>
                 <div class="tm-stories-card-empty__title-block"></div>
                </div>
               </div>
              </div><!---->
             </div><!---->
            </section>
            <section data-async-called="true" class="tm-block tm-block tm-block_spacing-around">
             <header class="tm-block__header tm-block__header">
              <div class="tm-block__header-container">
               <h2 class="tm-block__title tm-block__title">Работа</h2>
              </div><!---->
             </header>
             <div class="tm-block__body tm-block__body">
              <div class="tm-vacancies-block__item">
               <div class="tm-vacancies-block__vacancies-count">
                38 вакансий
               </div>
              </div>
              <div class="tm-vacancies-block__item">
               <div class="tm-vacancies-block__vacancies-count">
                110 вакансий
               </div>
              </div>
             </div>
             <footer class="tm-block__footer"></footer>
            </section>
            <section data-async-called="true" class="tm-block block tm-block tm-block_spacing-around" data-v-cb9bff32>
             <header class="tm-block__header tm-block__header">
              <div class="tm-block__header-container">
               <h2 class="tm-block__title tm-block__title">Ближайшие события</h2>
              </div><!---->
             </header>
             <div class="tm-block__body tm-block__body">
              <div class="swiper-container slider" style="--swiper-space-between:22px;" data-v-cb9bff32>
               <div class="swiper-wrapper">
                <div class="swiper-slide" data-v-cb9bff32>
                 <section id="events_130" tabindex="-1" class="tm-block tm-block tm-block_spacing-none" data-v-cb9bff32>
                  <!---->
                  <div class="tm-event-card tm-event-card_is-widget">
                   <!---->
                   <div class="tm-event-card__info">
                    <div class="tm-event-card__date">
                     <div class="tm-event-card__day">
                      <span>1 – 29 февраля </span>
                     </div>
                     <div class="tm-event-card__time">
                      <span>11:00</span>
                     </div>
                    </div>
                    <div class="tm-event-card__places">
                     <div class="tm-event-card__places-list">
                      <span class="tm-event-card__places-item"><span>Онлайн</span> <!----></span>
                     </div>
                    </div>
                    <div class="tm-event-card__footer"></div>
                   </div><!---->
                  </div><!---->
                 </section>
                </div>
                <div class="swiper-slide" data-v-cb9bff32>
                 <section id="events_154" tabindex="-1" class="tm-block tm-block tm-block_spacing-none" data-v-cb9bff32>
                  <!---->
                  <div class="tm-event-card tm-event-card_is-widget">
                   <!---->
                   <div class="tm-event-card__info">
                    <div class="tm-event-card__date">
                     <div class="tm-event-card__day">
                      <span>5 – 29 февраля </span>
                     </div><!---->
                    </div>
                    <div class="tm-event-card__places">
                     <div class="tm-event-card__places-list">
                      <span class="tm-event-card__places-item"><span>Онлайн</span> <!----></span>
                     </div>
                    </div>
                    <div class="tm-event-card__footer"></div>
                   </div><!---->
                  </div><!---->
                 </section>
                </div>
                <div class="swiper-slide" data-v-cb9bff32>
                 <section id="events_162" tabindex="-1" class="tm-block tm-block tm-block_spacing-none" data-v-cb9bff32>
                  <!---->
                  <div class="tm-event-card tm-event-card_is-widget">
                   <!---->
                   <div class="tm-event-card__info">
                    <div class="tm-event-card__date">
                     <div class="tm-event-card__day">
                      <span>17 февраля </span>
                     </div>
                     <div class="tm-event-card__time">
                      <span>10:00</span>
                     </div>
                    </div>
                    <div class="tm-event-card__places">
                     <div class="tm-event-card__places-list">
                      <span class="tm-event-card__places-item"><span>Онлайн</span> <!----></span>
                     </div>
                    </div>
                    <div class="tm-event-card__footer"></div>
                   </div><!---->
                  </div><!---->
                 </section>
                </div>
                <div class="swiper-slide" data-v-cb9bff32>
                 <section id="events_142" tabindex="-1" class="tm-block tm-block tm-block_spacing-none" data-v-cb9bff32>
                  <!---->
                  <div class="tm-event-card tm-event-card_is-widget">
                   <!---->
                   <div class="tm-event-card__info">
                    <div class="tm-event-card__date">
                     <div class="tm-event-card__day">
                      <span>18 – 19 февраля </span>
                     </div><!---->
                    </div>
                    <div class="tm-event-card__places">
                     <div class="tm-event-card__places-list">
                      <span class="tm-event-card__places-item"><span>Онлайн</span> <!----></span>
                     </div>
                    </div>
                    <div class="tm-event-card__footer"></div>
                   </div><!---->
                  </div><!---->
                 </section>
                </div>
                <div class="swiper-slide" data-v-cb9bff32>
                 <section id="events_174" tabindex="-1" class="tm-block tm-block tm-block_spacing-none" data-v-cb9bff32>
                  <!---->
                  <div class="tm-event-card tm-event-card_is-widget">
                   <!---->
                   <div class="tm-event-card__info">
                    <div class="tm-event-card__date">
                     <div class="tm-event-card__day">
                      <span>19 февраля </span>
                     </div>
                     <div class="tm-event-card__time">
                      <span>17:00</span>
                     </div>
                    </div>
                    <div class="tm-event-card__places">
                     <div class="tm-event-card__places-list">
                      <span class="tm-event-card__places-item"><span>Онлайн</span> <!----></span>
                     </div>
                    </div>
                    <div class="tm-event-card__footer"></div>
                   </div><!---->
                  </div><!---->
                 </section>
                </div>
                <div class="swiper-slide" data-v-cb9bff32>
                 <section id="events_156" tabindex="-1" class="tm-block tm-block tm-block_spacing-none" data-v-cb9bff32>
                  <!---->
                  <div class="tm-event-card tm-event-card_is-widget">
                   <!---->
                   <div class="tm-event-card__info">
                    <div class="tm-event-card__date">
                     <div class="tm-event-card__day">
                      <span>19 февраля </span>
                     </div>
                     <div class="tm-event-card__time">
                      <span>19:00</span>
                     </div>
                    </div>
                    <div class="tm-event-card__places">
                     <div class="tm-event-card__places-list">
                      <span class="tm-event-card__places-item"><span>Онлайн</span> <!----></span>
                     </div>
                    </div>
                    <div class="tm-event-card__footer"></div>
                   </div><!---->
                  </div><!---->
                 </section>
                </div>
                <div class="swiper-slide" data-v-cb9bff32>
                 <section id="events_164" tabindex="-1" class="tm-block tm-block tm-block_spacing-none" data-v-cb9bff32>
                  <!---->
                  <div class="tm-event-card tm-event-card_is-widget">
                   <!---->
                   <div class="tm-event-card__info">
                    <div class="tm-event-card__date">
                     <div class="tm-event-card__day">
                      <span>19 февраля </span>
                     </div>
                     <div class="tm-event-card__time">
                      <span>20:00</span>
                     </div>
                    </div>
                    <div class="tm-event-card__places">
                     <div class="tm-event-card__places-list">
                      <span class="tm-event-card__places-item"><span>Онлайн</span> <!----></span>
                     </div>
                    </div>
                    <div class="tm-event-card__footer"></div>
                   </div><!---->
                  </div><!---->
                 </section>
                </div>
                <div class="swiper-slide" data-v-cb9bff32>
                 <section id="events_170" tabindex="-1" class="tm-block tm-block tm-block_spacing-none" data-v-cb9bff32>
                  <!---->
                  <div class="tm-event-card tm-event-card_is-widget">
                   <!---->
                   <div class="tm-event-card__info">
                    <div class="tm-event-card__date">
                     <div class="tm-event-card__day">
                      <span>21 февраля </span>
                     </div>
                     <div class="tm-event-card__time">
                      <span>20:00</span>
                     </div>
                    </div>
                    <div class="tm-event-card__places">
                     <div class="tm-event-card__places-list">
                      <span class="tm-event-card__places-item"><span>Онлайн</span> <!----></span>
                     </div>
                    </div>
                    <div class="tm-event-card__footer"></div>
                   </div><!---->
                  </div><!---->
                 </section>
                </div>
                <div class="swiper-slide" data-v-cb9bff32>
                 <section id="events_172" tabindex="-1" class="tm-block tm-block tm-block_spacing-none" data-v-cb9bff32>
                  <!---->
                  <div class="tm-event-card tm-event-card_is-widget">
                   <!---->
                   <div class="tm-event-card__info">
                    <div class="tm-event-card__date">
                     <div class="tm-event-card__day">
                      <span>21 февраля </span>
                     </div>
                     <div class="tm-event-card__time">
                      <span>20:00</span>
                     </div>
                    </div>
                    <div class="tm-event-card__places">
                     <div class="tm-event-card__places-list">
                      <span class="tm-event-card__places-item"><span>Онлайн</span> <!----></span>
                     </div>
                    </div>
                    <div class="tm-event-card__footer"></div>
                   </div><!---->
                  </div><!---->
                 </section>
                </div>
                <div class="swiper-slide" data-v-cb9bff32>
                 <section id="events_122" tabindex="-1" class="tm-block tm-block tm-block_spacing-none" data-v-cb9bff32>
                  <!---->
                  <div class="tm-event-card tm-event-card_is-widget">
                   <!---->
                   <div class="tm-event-card__info">
                    <div class="tm-event-card__date">
                     <div class="tm-event-card__day">
                      <span>27 февраля </span>
                     </div>
                     <div class="tm-event-card__time">
                      <span>20:00</span>
                     </div>
                    </div>
                    <div class="tm-event-card__places">
                     <div class="tm-event-card__places-list">
                      <span class="tm-event-card__places-item"><span>Онлайн</span> <!----></span>
                     </div>
                    </div>
                    <div class="tm-event-card__footer"></div>
                   </div><!---->
                  </div><!---->
                 </section>
                </div>
                <div class="swiper-slide" data-v-cb9bff32>
                 <section id="events_176" tabindex="-1" class="tm-block tm-block tm-block_spacing-none" data-v-cb9bff32>
                  <!---->
                  <div class="tm-event-card tm-event-card_is-widget">
                   <!---->
                   <div class="tm-event-card__info">
                    <div class="tm-event-card__date">
                     <div class="tm-event-card__day">
                      <span>1 марта – 19 апреля </span>
                     </div>
                     <div class="tm-event-card__time">
                      <span>19:00</span>
                     </div>
                    </div>
                    <div class="tm-event-card__places">
                     <div class="tm-event-card__places-list">
                      <span class="tm-event-card__places-item"><span>Онлайн</span> <!----></span>
                     </div>
                    </div>
                    <div class="tm-event-card__footer"></div>
                   </div><!---->
                  </div><!---->
                 </section>
                </div>
                <div class="swiper-slide" data-v-cb9bff32>
                 <section id="events_140" tabindex="-1" class="tm-block tm-block tm-block_spacing-none" data-v-cb9bff32>
                  <!---->
                  <div class="tm-event-card tm-event-card_is-widget">
                   <!---->
                   <div class="tm-event-card__info">
                    <div class="tm-event-card__date">
                     <div class="tm-event-card__day">
                      <span>4 – 5 марта </span>
                     </div>
                     <div class="tm-event-card__time">
                      <span>10:00 – 20:00</span>
                     </div>
                    </div>
                    <div class="tm-event-card__places">
                     <div class="tm-event-card__places-list">
                      <span class="tm-event-card__places-item"><span>Москва</span> <span class="tm-event-card__places-separator"> • </span></span><span class="tm-event-card__places-item"><span>Онлайн</span> <!----></span>
                     </div>
                    </div>
                    <div class="tm-event-card__footer"></div>
                   </div><!---->
                  </div><!---->
                 </section>
                </div>
                <div class="swiper-slide" data-v-cb9bff32>
                 <section id="events_160" tabindex="-1" class="tm-block tm-block tm-block_spacing-none" data-v-cb9bff32>
                  <!---->
                  <div class="tm-event-card tm-event-card_is-widget">
                   <!---->
                   <div class="tm-event-card__info">
                    <div class="tm-event-card__date">
                     <div class="tm-event-card__day">
                      <span>21 марта </span>
                     </div>
                     <div class="tm-event-card__time">
                      <span>09:00 – 18:00</span>
                     </div>
                    </div>
                    <div class="tm-event-card__places">
                     <div class="tm-event-card__places-list">
                      <span class="tm-event-card__places-item"><span>Москва</span> <span class="tm-event-card__places-separator"> • </span></span><span class="tm-event-card__places-item"><span>Онлайн</span> <!----></span>
                     </div>
                    </div>
                    <div class="tm-event-card__footer"></div>
                   </div><!---->
                  </div><!---->
                 </section>
                </div>
               </div><!----> <button class="swiper-button-prev"><span class="tm-svg-icon__wrapper swiper-button-icon"></span></button> <button class="swiper-button-next"><span class="tm-svg-icon__wrapper swiper-button-icon"></span></button>
              </div>
             </div><!---->
            </section>
            <div class="tm-adfox-banner__container tm-layout-sidebar__banner tm-layout-sidebar__banner_bottom">
             <!---->
             <div id="adfox_164725691003361602" class="tm-adfox-banner tm-adfox-banner tm-adfox-banner_variant-medium-rectangle"></div>
            </div>
           </div>
          </div>
         </div>
        </div>
       </div>
      </div>
     </main><!---->
    </div>
    <div class="tm-footer-menu">
     <div class="tm-page-width">
      <div class="tm-footer-menu__container">
       <div class="tm-footer-menu__block">
        <p class="tm-footer-menu__block-title">Ваш аккаунт</p>
        <div class="tm-footer-menu__block-content">
         <ul class="tm-footer-menu__list"></ul>
        </div>
       </div>
       <div class="tm-footer-menu__block">
        <p class="tm-footer-menu__block-title">Разделы</p>
        <div class="tm-footer-menu__block-content">
         <ul class="tm-footer-menu__list"></ul>
        </div>
       </div>
       <div class="tm-footer-menu__block">
        <p class="tm-footer-menu__block-title">Информация</p>
        <div class="tm-footer-menu__block-content">
         <ul class="tm-footer-menu__list"></ul>
        </div>
       </div>
       <div class="tm-footer-menu__block">
        <p class="tm-footer-menu__block-title">Услуги</p>
        <div class="tm-footer-menu__block-content">
         <ul class="tm-footer-menu__list"></ul>
        </div>
       </div>
      </div>
     </div>
    </div>
    <div class="tm-footer">
     <div class="tm-page-width">
      <div class="tm-footer__container">
       <!---->
       <div class="tm-footer__social"></div>
       <div class="v-portal" style="display:none;"></div><button class="tm-footer__link"><!----> Настройка языка </button>
       <div class="tm-footer-copyright">
        <span class="tm-copyright"><span class="tm-copyright__years">© 2006–2024, </span> <span class="tm-copyright__name"></span></span>
       </div>
      </div>
     </div>
    </div><!---->
   </div>
   <div class="vue-portal-target"></div>
  </div>
  <noscript>
   <div>
   </div>
  </noscript>
 </body>
</html>